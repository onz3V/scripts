# -*- coding: utf-8 -*
import base64
decode = "ZnJvbSB1cmxsaWIucGFyc2UgaW1wb3J0IHVucXVvdGUNCmltcG9ydCBiYXNlNjQNCmltcG9ydCBodHRwLmNsaWVudA0KaW1wb3J0IGpzb24NCmltcG9ydCBvcw0KaW1wb3J0IHN5cw0KaW1wb3J0IHJlDQp0cnk6DQogICAgaW1wb3J0IHJlcXVlc3RzDQpleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgcHJpbnQoZSwgJ1xu57y65bCRcmVxdWVzdHPmqKHlnZcsIOivt+aJp+ihjOWRveS7pO+8mnBpcDMgaW5zdGFsbCByZXF1ZXN0c1xuJykNCiAgICBzeXMuZXhpdCgxKQ0Kb3MuZW52aXJvblsnbm9fcHJveHknXSA9ICcqJw0KcmVxdWVzdHMucGFja2FnZXMudXJsbGliMy5kaXNhYmxlX3dhcm5pbmdzKCkNCg0KDQpkZWYgcWxfbG9naW4oKToNCiAgICBwYXRoID0gJy9xbC9jb25maWcvYXV0aC5qc29uJw0KICAgIGlmIG9zLnBhdGguaXNmaWxlKHBhdGgpOg0KICAgICAgICB3aXRoIG9wZW4ocGF0aCwgJ3InKWFzIGZpbGU6DQogICAgICAgICAgICBhdXRoID0gZmlsZS5yZWFkKCkNCiAgICAgICAgICAgIGZpbGUuY2xvc2UoKQ0KICAgICAgICBhdXRoID0ganNvbi5sb2FkcyhhdXRoKQ0KICAgICAgICB1c2VybmFtZSA9IGF1dGhbJ3VzZXJuYW1lJ10NCiAgICAgICAgcGFzc3dvcmQgPSBhdXRoWydwYXNzd29yZCddDQogICAgICAgIHRva2VuID0gYXV0aFsndG9rZW4nXQ0KICAgICAgICBpZiB0b2tlbiA9PSAnJzoNCiAgICAgICAgICAgIHVybCA9ICdodHRwOi8vMTI3LjAuMC4xOjU3MDAvYXBpL2xvZ2luJw0KICAgICAgICAgICAgcGF5bG9hZCA9IHsndXNlcm5hbWUnOiB1c2VybmFtZSwgJ3Bhc3N3b3JkJzogcGFzc3dvcmR9DQogICAgICAgICAgICBoZWFkZXJzID0geydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9DQogICAgICAgICAgICByZXMgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGhlYWRlcnM9aGVhZGVycywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YT1wYXlsb2FkLCB2ZXJpZnk9RmFsc2UpDQogICAgICAgICAgICB0b2tlbiA9IGpzb24ubG9hZHMocmVzLnRleHQpWyd0b2tlbiddDQogICAgICAgICAgICByZXR1cm4gdG9rZW4NCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHJldHVybiB0b2tlbg0KICAgIGVsc2U6DQogICAgICAgIHByaW50KCfmsqHmnInlj5HnjrBhdXRo5paH5Lu2LCDkvaDov5nmmK/pnZLpvpnlkJc/Pz8nKQ0KICAgICAgICBzeXMuZXhpdCgwKQ0KDQoNCmRlZiBnZXRfY2soKToNCiAgICBpZiAnSkRfQ09PS0lFJyBpbiBvcy5lbnZpcm9uOg0KICAgICAgICBja19saXN0ID0gb3MuZW52aXJvblsnSkRfQ09PS0lFJ10uc3BsaXQoJyYnKQ0KICAgICAgICBpZiBsZW4oY2tfbGlzdCkgPiAwOg0KICAgICAgICAgICAgcmV0dXJuIGNrX2xpc3QNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHByaW50KCdKRF9DT09LSUXlj5jph4/mnKrlkK/nlKgnKQ0KICAgICAgICAgICAgc3lzLmV4aXQoMSkNCiAgICBlbHNlOg0KICAgICAgICBwcmludCgn5pyq5re75YqgSkRfQ09PS0lF5Y+Y6YePJykNCiAgICAgICAgc3lzLmV4aXQoMCkNCg0KDQpkZWYgY2hlY2tfY2soY2spOg0KICAgIHVybCA9ICdodHRwczovL3dxLmpkLmNvbS91c2VyX25ldy9pbmZvL0dldEpEVXNlckluZm9Vbmlvbj9vcmdGbGFnPUpEX1BpbkdvdV9OZXcmY2FsbFNvdXJjZT1tYWlub3JkZXInDQogICAgaGVhZGVycyA9IHsnQ29va2llJzogY2ssICdSZWZlcmVyJzogJ2h0dHBzOi8vaG9tZS5tLmpkLmNvbS9teUpkL2hvbWUuYWN0aW9uJywNCiAgICAgICAgICAgICAgICdVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChpUGhvbmU7IENQVSBpUGhvbmUgT1MgMTRfMyBsaWtlIE1hYyBPUyBYKSBBcHBsZVdlYktpdC82MDUuMS4xNSAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vMTQuMC4yIE1vYmlsZS8xNUUxNDggU2FmYXJpLzYwNC4xJywgfQ0KICAgIHJlcyA9IHJlcXVlc3RzLmdldCh1cmw9dXJsLCBoZWFkZXJzPWhlYWRlcnMsIHZlcmlmeT1GYWxzZSwgdGltZW91dD0zMCkNCiAgICBpZiByZXMuc3RhdHVzX2NvZGUgPT0gMjAwOg0KICAgICAgICBjb2RlID0gaW50KGpzb24ubG9hZHMocmVzLnRleHQpWydyZXRjb2RlJ10pDQogICAgICAgIHBpbiA9IGNrLnNwbGl0KCc7JylbMV0NCiAgICAgICAgaWYgY29kZSA9PSAwOg0KICAgICAgICAgICAgcHJpbnQocGluLCAn54q25oCB5q2j5bi4XG4nKQ0KICAgICAgICAgICAgcmV0dXJuIFRydWUNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHByaW50KHBpbiwgJ+eKtuaAgeWkseaViFxuJykNCiAgICAgICAgICAgIHJldHVybiBGYWxzZQ0KICAgIGVsc2U6DQogICAgICAgIHJldHVybiBGYWxzZQ0KDQoNCmRlZiBzZWFyY2hfY2socGluKToNCiAgICBwaW4yID0gcGluLnJlcGxhY2UoJyUnLCAnJTVDJTI1JykNCiAgICBjb25uID0gaHR0cC5jbGllbnQuSFRUUENvbm5lY3Rpb24oJzEyNy4wLjAuMScsIDU3MDApDQogICAgcGF5bG9hZCA9ICcnDQogICAgaGVhZGVycyA9IHsnQXV0aG9yaXphdGlvbic6ICdCZWFyZXIgJyt0b2tlbn0NCiAgICB1cmwgPSAnL2FwaS9lbnZzP3NlYXJjaFZhbHVlPXswfScuZm9ybWF0KHBpbjIpDQogICAgY29ubi5yZXF1ZXN0KCdHRVQnLCB1cmwsIHBheWxvYWQsIGhlYWRlcnMpDQogICAgcmVzID0ganNvbi5sb2Fkcyhjb25uLmdldHJlc3BvbnNlKCkucmVhZCgpKQ0KICAgIGlmIGxlbihyZXNbJ2RhdGEnXSkgPT0gMDoNCiAgICAgICAgcHJpbnQocGluLCAn5qOA57Si5aSx6LSlXG4nKQ0KICAgICAgICByZXR1cm4gRmFsc2UsIDENCiAgICBlbGlmIGxlbihyZXNbJ2RhdGEnXSkgPiAxOg0KICAgICAgICBwcmludChwaW4sICdQaW7lrZjlnKjph43lpI0sIOWPluesrOS4gOadoVxuJykNCiAgICAgICAga2V5ID0gcmVzWydkYXRhJ11bMF1bJ3ZhbHVlJ10NCiAgICAgICAgZWlkID0gcmVzWydkYXRhJ11bMF1bJ19pZCddDQogICAgICAgIHJldHVybiBUcnVlLCBrZXksIGVpZA0KICAgIGVsc2U6DQogICAgICAgIHByaW50KHBpbiwgJ+ajgOe0ouaIkOWKn1xuJykNCiAgICAgICAga2V5ID0gcmVzWydkYXRhJ11bMF1bJ3ZhbHVlJ10NCiAgICAgICAgZWlkID0gcmVzWydkYXRhJ11bMF1bJ19pZCddDQogICAgICAgIHJldHVybiBUcnVlLCBlaWQNCg0KIyDph43mlrDmjpLluo8NCg0KDQpkZWYgc29ydCgpOg0KICAgIGNvbm4gPSBodHRwLmNsaWVudC5IVFRQQ29ubmVjdGlvbignMTI3LjAuMC4xJywgNTcwMCkNCiAgICBwYXlsb2FkID0gJycNCiAgICB1cmwgPSAnL2FwaS9lbnZzJw0KICAgIGhlYWRlcnMgPSB7J0F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcrdG9rZW59DQogICAgY29ubi5yZXF1ZXN0KCdHRVQnLCB1cmwsIHBheWxvYWQsIGhlYWRlcnMpDQogICAgcmVzID0ganNvbi5sb2Fkcyhjb25uLmdldHJlc3BvbnNlKCkucmVhZCgpKQ0KICAgIHJlcyA9IHJlc1snZGF0YSddDQogICAgaW5kZXggPSAwDQogICAgcHJlSWRMaXN0ID0gW10NCiAgICBmb3IgaSBpbiByYW5nZShsZW4ocmVzKSk6DQogICAgICAgIGlmKHJlc1tpXVsnbmFtZSddID09ICdKRF9DT09LSUUnKToNCiAgICAgICAgICAgIHIgPSByZS5jb21waWxlKHIncHRfcGluPSguKj8pOycpDQogICAgICAgICAgICBwaW4gPSByLmZpbmRhbGwocmVzW2ldWyd2YWx1ZSddKQ0KICAgICAgICAgICAgcGluID0gdW5xdW90ZShwaW5bMF0pDQogICAgICAgICAgICBwcmVJZExpc3QuYXBwZW5kKHJlc1tpXVsnX2lkJ10pDQogICAgICAgICAgICBpZihwaW4gPT0gbXlwaW4pOg0KICAgICAgICAgICAgICAgIGluZGV4ID0gaQ0KICAgICAgICAgICAgICAgIGJyZWFrDQogICAgaWYoaW5kZXggIT0gMCk6DQogICAgICAgIHByaW50KCIjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXG5UaGVyZSBhcmUiLCBsZW4ocHJlSWRMaXN0KS0xLA0KICAgICAgICAgICAgICAiY29va2llcyBpbiBmcm9udCxuZWVkIiwgbGVuKHByZUlkTGlzdCksICJpbnNlcnRpb25zLlxuIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyIpDQogICAgICAgICMg5oiq5Y+W5pWw57uE77yM5oiq5Y+W5Yiw6ZyA6KaB5pS+5Yiw56ys5LiA5L2NY2vnmoTkvY3nva4NCiAgICAgICAgcHJlTGlzdCA9IHJlc1s6aW5kZXgrMV0NCiAgICAgICAgIyBwcmludChwcmVMaXN0KQ0KICAgICAgICAjIOaKiuacgOWQjuS4gOS9jeaUvuWIsOesrOS4gOS9jQ0KICAgICAgICBwcmVMaXN0Lmluc2VydCgwLCBwcmVMaXN0LnBvcCgpKQ0KICAgICAgICAjIOW+queOr+aPkuWFpeabtOaWsGNr6aG65bqPDQogICAgICAgIGZvciBpIGluIHJhbmdlKGxlbihwcmVMaXN0KSk6DQogICAgICAgICAgICBsaXN0ID0geyduYW1lJzogJ0pEX0NPT0tJRScsICd2YWx1ZSc6IHByZUxpc3RbaV1bJ3ZhbHVlJ10sICdfaWQnOiBwcmVJZExpc3RbaV0sDQogICAgICAgICAgICAgICAgICAgICdyZW1hcmtzJzogcHJlTGlzdFtpXVsncmVtYXJrcyddIGlmICdyZW1hcmtzJyBpbiBwcmVMaXN0W2ldIGVsc2UgIiJ9DQogICAgICAgICAgICBxbF91cGRhdGUobGlzdCkNCiAgICBlbHNlOg0KICAgICAgICBwcmludCgnJycNCiAgICAgICAgXw0KICAgICAgIChcXCAgXyAgICAgICAgICAgICAgICAgICAgICBfX18NCiAgICAgIC4tImAiKFxcICAgICAgICAgICAgICAgIF8uIiJgICAgYCItLg0KICAgICAvICAgICAgYCBgLS5fICAgICAgICBfLi0iICAgICAgICAgICAgYFxfXw0KICAgIDYgICA2KSAgICAgICAgYC0uX18uLScgICAgICAgICAgICAgICAgICAgIGAiLA0KICAgLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYDstYA0KICAvICAgICAsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCiAoKSAgICAvICAvYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8DQogIGAtLS1gIn5gYFwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfA0KICAgICAgICAgICAgXCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCiAgICAgICAgICAgICBcICAgICAgICAgICAgXCAgICAgIC8gICAgICAgICAgIC8NCiAgICAgICAgICAgICAvYCwgICAsICAgICAgfCAgICAgfCAgICAgICAgICAgLw0KICAgICAgICAgICAgLyAgICItLnwgICAgICB8ICAgICB8ICAgICAgICAgLycNCiAgICAgICAgICAgLyAgICAgLyB8ICAgICAvLF9fICAgfCAgICAgICAvYFwgDQogICAgICAgICAvICAgIC8nICB8ICAgIC8gICAgYCInXCAgICAgICggICBcIA0KICAgICAgIF9fLyAgIC8nICAgIHwgICB8ICAgICAgICAgYFwgICAgIFwgICBcIA0KICAgICAgIFwgICAgLyAgICAgIHwgICB8ICAgICAgICAgICBgXCAgICBcICAgXCANCiAgICAgICAgYC0sLyAgICAgIC8gICAgfCAgICAgICAgICAgIC8gICAgIHwtImANCiAgICAgICAgICAgICAgICAgYCIiIl5eXiAgICAgICAgICAgYF5eIiIiImANCg0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgVSBhcmUgdGhlIGZpcnN0LCBkb24ndCBydW4gdGhpcyBzY3JpcHQuDQonJycpDQoNCg0KZGVmIHFsX3VwZGF0ZShkYXRhKToNCiAgICBwcmludChkYXRhWyd2YWx1ZSddKQ0KICAgIHVybCA9ICdodHRwOi8vMTI3LjAuMC4xOjU3MDAvYXBpL2VudnMnDQogICAgZGF0YSA9IGpzb24uZHVtcHMoZGF0YSkNCiAgICByZXMgPSBqc29uLmxvYWRzKHMucHV0KHVybD11cmwsIGRhdGE9ZGF0YSkudGV4dCkNCiAgICBpZihyZXNbJ2NvZGUnXSA9PSAyMDApOg0KICAgICAgICBwcmludCgnLS0tLS0tLS0tLS0tLS0tLS0tLS1cbnVwZGF0ZSBzdWNjZXNzXG4tLS0tLS0tLS0tLS0tLS0tLS0tLScpDQoNCg0KaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoNCiAgICB0b2tlbiA9IHFsX2xvZ2luKCkNCiAgICBzID0gcmVxdWVzdHMuc2Vzc2lvbigpDQogICAgcy5oZWFkZXJzLnVwZGF0ZSh7J2F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcrc3RyKHRva2VuKX0pDQogICAgcy5oZWFkZXJzLnVwZGF0ZSh7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9VVRGLTgnfSkNCiAgICBpZiAnbXlwaW4nIGluIG9zLmVudmlyb246DQogICAgICAgIG15cGluID0gb3MuZW52aXJvblsnbXlwaW4nXQ0KICAgIGVsc2U6DQogICAgICAgIGluZGV4ID0gLTENCiAgICAgICAgY2tMaXN0ID0gZ2V0X2NrKCkNCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UobGVuKGNrTGlzdCkpOg0KICAgICAgICAgICAgciA9IHJlLmNvbXBpbGUocidwdF9waW49KC4qPyk7JykNCiAgICAgICAgICAgIHBpbiA9IHIuZmluZGFsbChja0xpc3RbaV0pDQogICAgICAgICAgICBwaW4gPSB1bnF1b3RlKHBpblswXSkNCiAgICAgICAgICAgIGlmKHBpbiA9PSAiamRfN2Y1YTU1MTBlYzc5NyIpOg0KICAgICAgICAgICAgICAgIGluZGV4ID0gaQ0KICAgICAgICAgICAgICAgIG15cGluID0gJ2pkXzdmNWE1NTEwZWM3OTcnDQogICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgaWYoaW5kZXggPT0gLTEpOg0KICAgICAgICAgICAgcHJpbnQoIkRvbid0IGZpbmQgeW91ciBQaW4scGx6IGNoZWNrIGl0ISIpDQogICAgcHJpbnQoImBgYFRoZSBwaW4gdGhhdCB5b3Ugc2V0IGlzIiwgbXlwaW4sICIuYGBgIikNCiAgICBzb3J0KCkNCiAgICBzeXMuZXhpdCgwKQ0K"
exec(base64.b64decode(decode).decode('utf-8'))
