# -*- coding: utf-8 -*
import base64
decode = "ZnJvbSB1cmxsaWIucGFyc2UgaW1wb3J0IHVucXVvdGUKaW1wb3J0IGJhc2U2NAppbXBvcnQgaHR0cC5jbGllbnQKaW1wb3J0IGpzb24KaW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IHJlCnRyeToKICAgIGltcG9ydCByZXF1ZXN0cwpleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICBwcmludChlLCAnXG7nvLrlsJFyZXF1ZXN0c+aooeWdlywg6K+35omn6KGM5ZG95Luk77yacGlwMyBpbnN0YWxsIHJlcXVlc3RzXG4nKQogICAgc3lzLmV4aXQoMSkKb3MuZW52aXJvblsnbm9fcHJveHknXSA9ICcqJwpyZXF1ZXN0cy5wYWNrYWdlcy51cmxsaWIzLmRpc2FibGVfd2FybmluZ3MoKQoKCmRlZiBxbF9sb2dpbigpOgogICAgcGF0aCA9ICcvcWwvY29uZmlnL2F1dGguanNvbicKICAgIGlmIG9zLnBhdGguaXNmaWxlKHBhdGgpOgogICAgICAgIHdpdGggb3BlbihwYXRoLCAncicpYXMgZmlsZToKICAgICAgICAgICAgYXV0aCA9IGZpbGUucmVhZCgpCiAgICAgICAgICAgIGZpbGUuY2xvc2UoKQogICAgICAgIGF1dGggPSBqc29uLmxvYWRzKGF1dGgpCiAgICAgICAgdXNlcm5hbWUgPSBhdXRoWyd1c2VybmFtZSddCiAgICAgICAgcGFzc3dvcmQgPSBhdXRoWydwYXNzd29yZCddCiAgICAgICAgdG9rZW4gPSBhdXRoWyd0b2tlbiddCiAgICAgICAgaWYgdG9rZW4gPT0gJyc6CiAgICAgICAgICAgIHVybCA9ICdodHRwOi8vMTI3LjAuMC4xOjU3MDAvYXBpL2xvZ2luJwogICAgICAgICAgICBwYXlsb2FkID0geyd1c2VybmFtZSc6IHVzZXJuYW1lLCAncGFzc3dvcmQnOiBwYXNzd29yZH0KICAgICAgICAgICAgaGVhZGVycyA9IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfQogICAgICAgICAgICByZXMgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGhlYWRlcnM9aGVhZGVycywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhPXBheWxvYWQsIHZlcmlmeT1GYWxzZSkKICAgICAgICAgICAgdG9rZW4gPSBqc29uLmxvYWRzKHJlcy50ZXh0KVsndG9rZW4nXQogICAgICAgICAgICByZXR1cm4gdG9rZW4KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gdG9rZW4KICAgIGVsc2U6CiAgICAgICAgcHJpbnQoJ+ayoeacieWPkeeOsGF1dGjmlofku7YsIOS9oOi/meaYr+mdkum+meWQlz8/PycpCiAgICAgICAgc3lzLmV4aXQoMCkKCgpkZWYgZ2V0X2NrKCk6CiAgICBpZiAnSkRfQ09PS0lFJyBpbiBvcy5lbnZpcm9uOgogICAgICAgIGNrX2xpc3QgPSBvcy5lbnZpcm9uWydKRF9DT09LSUUnXS5zcGxpdCgnJicpCiAgICAgICAgaWYgbGVuKGNrX2xpc3QpID4gMDoKICAgICAgICAgICAgcmV0dXJuIGNrX2xpc3QKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludCgnSkRfQ09PS0lF5Y+Y6YeP5pyq5ZCv55SoJykKICAgICAgICAgICAgc3lzLmV4aXQoMSkKICAgIGVsc2U6CiAgICAgICAgcHJpbnQoJ+acqua3u+WKoEpEX0NPT0tJReWPmOmHjycpCiAgICAgICAgc3lzLmV4aXQoMCkKCmRlZiBnZXRfYWxsX2NrKCk6CiAgICBjb25uID0gaHR0cC5jbGllbnQuSFRUUENvbm5lY3Rpb24oJzEyNy4wLjAuMScsIDU3MDApCiAgICBwYXlsb2FkID0gJycKICAgIHVybCA9ICcvYXBpL2VudnMnCiAgICBoZWFkZXJzID0geydBdXRob3JpemF0aW9uJzogJ0JlYXJlciAnK3Rva2VufQogICAgY29ubi5yZXF1ZXN0KCdHRVQnLCB1cmwsIHBheWxvYWQsIGhlYWRlcnMpCiAgICByZXMgPSBqc29uLmxvYWRzKGNvbm4uZ2V0cmVzcG9uc2UoKS5yZWFkKCkpCiAgICByZXMgPSByZXNbJ2RhdGEnXQogICAgZ2xvYmFsIGNrX2xpc3QKICAgIGNrX2xpc3QgPSBbXQogICAgZm9yIGkgaW4gcmFuZ2UobGVuKHJlcykpOgogICAgICAgIGlmKHJlc1tpXVsnbmFtZSddID09ICdKRF9DT09LSUUnKToKICAgICAgICAgICAgciA9IHJlLmNvbXBpbGUocidwdF9waW49KC4qPyk7JykKICAgICAgICAgICAgcGlucyA9IHIuZmluZGFsbChyZXNbaV1bJ3ZhbHVlJ10pCiAgICAgICAgICAgIGNrX2xpc3QuYXBwZW5kKHJlc1tpXSkKCmRlZiBjaGVja19jayhjayk6CiAgICB1cmwgPSAnaHR0cHM6Ly93cS5qZC5jb20vdXNlcl9uZXcvaW5mby9HZXRKRFVzZXJJbmZvVW5pb24/b3JnRmxhZz1KRF9QaW5Hb3VfTmV3JmNhbGxTb3VyY2U9bWFpbm9yZGVyJwogICAgaGVhZGVycyA9IHsnQ29va2llJzogY2ssICdSZWZlcmVyJzogJ2h0dHBzOi8vaG9tZS5tLmpkLmNvbS9teUpkL2hvbWUuYWN0aW9uJywKICAgICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKGlQaG9uZTsgQ1BVIGlQaG9uZSBPUyAxNF8zIGxpa2UgTWFjIE9TIFgpIEFwcGxlV2ViS2l0LzYwNS4xLjE1IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi8xNC4wLjIgTW9iaWxlLzE1RTE0OCBTYWZhcmkvNjA0LjEnLCB9CiAgICByZXMgPSByZXF1ZXN0cy5nZXQodXJsPXVybCwgaGVhZGVycz1oZWFkZXJzLCB2ZXJpZnk9RmFsc2UsIHRpbWVvdXQ9MzApCiAgICBpZiByZXMuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgIGNvZGUgPSBpbnQoanNvbi5sb2FkcyhyZXMudGV4dClbJ3JldGNvZGUnXSkKICAgICAgICBwaW4gPSBjay5zcGxpdCgnOycpWzFdCiAgICAgICAgaWYgY29kZSA9PSAwOgogICAgICAgICAgICBwcmludChwaW4sICfnirbmgIHmraPluLhcbicpCiAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQocGluLCAn54q25oCB5aSx5pWIXG4nKQogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIEZhbHNlCgoKZGVmIHNlYXJjaF9jayhwaW4pOgogICAgcGluMiA9IHBpbi5yZXBsYWNlKCclJywgJyU1QyUyNScpCiAgICBjb25uID0gaHR0cC5jbGllbnQuSFRUUENvbm5lY3Rpb24oJzEyNy4wLjAuMScsIDU3MDApCiAgICBwYXlsb2FkID0gJycKICAgIGhlYWRlcnMgPSB7J0F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcrdG9rZW59CiAgICB1cmwgPSAnL2FwaS9lbnZzP3NlYXJjaFZhbHVlPXswfScuZm9ybWF0KHBpbjIpCiAgICBjb25uLnJlcXVlc3QoJ0dFVCcsIHVybCwgcGF5bG9hZCwgaGVhZGVycykKICAgIHJlcyA9IGpzb24ubG9hZHMoY29ubi5nZXRyZXNwb25zZSgpLnJlYWQoKSkKICAgIGlmIGxlbihyZXNbJ2RhdGEnXSkgPT0gMDoKICAgICAgICBwcmludChwaW4sICfmo4DntKLlpLHotKVcbicpCiAgICAgICAgcmV0dXJuIEZhbHNlLCAxCiAgICBlbGlmIGxlbihyZXNbJ2RhdGEnXSkgPiAxOgogICAgICAgIHByaW50KHBpbiwgJ1BpbuWtmOWcqOmHjeWkjSwg5Y+W56ys5LiA5p2hXG4nKQogICAgICAgIGtleSA9IHJlc1snZGF0YSddWzBdWyd2YWx1ZSddCiAgICAgICAgZWlkID0gcmVzWydkYXRhJ11bMF1bJ2lkJ10KICAgICAgICByZXR1cm4gVHJ1ZSwga2V5LCBlaWQKICAgIGVsc2U6CiAgICAgICAgcHJpbnQocGluLCAn5qOA57Si5oiQ5YqfXG4nKQogICAgICAgIGtleSA9IHJlc1snZGF0YSddWzBdWyd2YWx1ZSddCiAgICAgICAgZWlkID0gcmVzWydkYXRhJ11bMF1bJ2lkJ10KICAgICAgICByZXR1cm4gVHJ1ZSwgZWlkCiAgICAgICAgCmRlZiBwb3NpdGlvbigpOgogICAgZ2xvYmFsIHBvc2l0aW9uMQogICAgcG9zaXRpb24xID0gMAogICAgcG9zaXRpb24yID0gMAogICAgZm9yIGkgaW4gcmFuZ2UobGVuKGNrX2xpc3QpKToKICAgICAgICByID0gcmUuY29tcGlsZShyJ3B0X3Bpbj0oLio/KTsnKQogICAgICAgIHBpbnMgPSByLmZpbmRhbGwoY2tfbGlzdFtpXVsndmFsdWUnXSkKICAgICAgICBmb3IgaiBpbiByYW5nZShsZW4ocGlucykpOgogICAgICAgICAgICBwaW4gPSB1bnF1b3RlKHBpbnNbal0pCiAgICAgICAgICAgIGlmKHBpbiA9PSBteXBpbik6CiAgICAgICAgICAgICAgICBwb3NpdGlvbjEgPSBpCiAgICAgICAgICAgICAgICBwb3NpdGlvbjIgPSBqCiAgICAgICAgICAgICAgICBicmVhawogICAgIyDmiormiJHliY3pnaLnmoRja+WOu+aOiQogICAgaWYocG9zaXRpb24yICE9IDApOgogICAgICAgICPmi7/liLDmiJHnmoRDSwogICAgICAgIHByaW50KGNrX2xpc3RbcG9zaXRpb24xXVsndmFsdWUnXS5zcGxpdCgiJiIpW3Bvc2l0aW9uMl0pCiAgICAgICAgbGlzdCA9IHsndmFsdWUnOiBja19saXN0W3Bvc2l0aW9uMV1bJ3ZhbHVlJ10uc3BsaXQoIiYiKVtwb3NpdGlvbjJdLCAnaWQnOiBja19saXN0W3Bvc2l0aW9uMV1bJ2lkJ10sICAnbmFtZSc6ICdKRF9DT09LSUUnLAogICAgICAgICdyZW1hcmtzJzogY2tfbGlzdFtwb3NpdGlvbjFdWydyZW1hcmtzJ10gaWYgJ3JlbWFya3MnIGluIGNrX2xpc3RbcG9zaXRpb24xXSBlbHNlICIifQogICAgICAgIHFsX3VwZGF0ZShsaXN0KQogICAgZWxzZToKICAgICAgICBwcmludCgn5peg6Z2e5rOV5pON5L2cXG4nKQoKIyDph43mlrDmjpLluo8KZGVmIHNvcnQoKToKICAgIGlmKHBvc2l0aW9uMSA9PSAwKToKICAgICAgICBwcmludCgn5peg6Z2e5rOV5pON5L2cXG4nKQogICAgZWxzZToKICAgICAgICAjIHByaW50KHBvc2l0aW9uMSkKICAgICAgICBmb3IgaSBpbiByYW5nZShwb3NpdGlvbjEsMCwtMSk6CiAgICAgICAgICAgICMgcHJpbnQoY2tfbGlzdFtpXVsncmVtYXJrcyddLGNrX2xpc3RbaS0xXVsncmVtYXJrcyddKQoKICAgICAgICAgICAgdGVtcCA9IHsndmFsdWUnOiBja19saXN0W2ldWyd2YWx1ZSddLCAnaWQnOiBja19saXN0W2ktMV1bJ2lkJ10sICAnbmFtZSc6ICdKRF9DT09LSUUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3JlbWFya3MnOiBja19saXN0W2ldWydyZW1hcmtzJ10gaWYgJ3JlbWFya3MnIGluIGNrX2xpc3RbaV0gZWxzZSAiIn0KICAgICAgICAgICAgY2tfbGlzdFtpXSA9IHsndmFsdWUnOiBja19saXN0W2ktMV1bJ3ZhbHVlJ10sICdpZCc6IGNrX2xpc3RbaV1bJ2lkJ10sICAnbmFtZSc6ICdKRF9DT09LSUUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3JlbWFya3MnOiBja19saXN0W2ktMV1bJ3JlbWFya3MnXSBpZiAncmVtYXJrcycgaW4gY2tfbGlzdFtpLTFdIGVsc2UgIiJ9CiAgICAgICAgICAgIGNrX2xpc3RbaS0xXSA9IHRlbXAKCiAgICAgICAgICAgICMgcHJpbnQoY2tfbGlzdFtpXVsncmVtYXJrcyddLGNrX2xpc3RbaS0xXVsncmVtYXJrcyddKQogICAgICAgICAgICAgICAgIyBja19saXN0LmFwcGVuZCh7J3ZhbHVlJzogcmVzW2ldWyd2YWx1ZSddLCAnaWQnOiByZXNbaV1bJ2lkJ10sICAnbmFtZSc6ICdKRF9DT09LSUUnLAogICAgICAgICAgICAgICAgIyAgICAgICAgICAgICAgICAncmVtYXJrcyc6IHJlc1tpXVsncmVtYXJrcyddIGlmICdyZW1hcmtzJyBpbiByZXNbaV0gZWxzZSAiIn0pCiAgICAgICAgICAgICAgICAjIGlmKHBpbiA9PSBteXBpbik6CiAgICAgICAgICAgICAgICAjICAgICBwcmludChpKQogICAgICAgICAgICAKICAgICAgICAjIHByaW50KGNrX2xpc3QpCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UocG9zaXRpb24xKzEpOgogICAgICAgICAgICBxbF91cGRhdGUoY2tfbGlzdFtpXSkKICAgICAgICAjIHByZV9saXN0ID0gcmVzWzozNF0KICAgICAgICAjIHByaW50KGNrX2xpc3QpCiAgICAgICAgIyBuZXdfbGlzdC5hcHBlbmQoKSAKCgpkZWYgcWxfdXBkYXRlKGRhdGEpOgogICAgIyBwcmludChkYXRhWyd2YWx1ZSddKQogICAgdXJsID0gJ2h0dHA6Ly8xMjcuMC4wLjE6NTcwMC9hcGkvZW52cycKICAgIGRhdGEgPSBqc29uLmR1bXBzKGRhdGEpCiAgICByZXMgPSBqc29uLmxvYWRzKHMucHV0KHVybD11cmwsIGRhdGE9ZGF0YSkudGV4dCkKICAgIGlmKHJlc1snY29kZSddID09IDIwMCk6CiAgICAgICAgcHJpbnQoJy0tLS0tLS0tLS0tLS0tLS0tLS0tXG51cGRhdGUgc3VjY2Vzc1xuLS0tLS0tLS0tLS0tLS0tLS0tLS0nKQoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBuZXdfbGlzdCA9IFtdCiAgICB0b2tlbiA9IHFsX2xvZ2luKCkKICAgIHMgPSByZXF1ZXN0cy5zZXNzaW9uKCkKICAgIHMuaGVhZGVycy51cGRhdGUoeydhdXRob3JpemF0aW9uJzogJ0JlYXJlciAnK3N0cih0b2tlbil9KQogICAgcy5oZWFkZXJzLnVwZGF0ZSh7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9VVRGLTgnfSkKICAgIGlmICdteXBpbicgaW4gb3MuZW52aXJvbjoKICAgICAgICBteXBpbiA9IG9zLmVudmlyb25bJ215cGluJ10KICAgIGVsc2U6CiAgICAgICAgaW5kZXggPSAtMQogICAgICAgIGNrTGlzdCA9IGdldF9jaygpCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UobGVuKGNrTGlzdCkpOgogICAgICAgICAgICByID0gcmUuY29tcGlsZShyJ3B0X3Bpbj0oLio/KTsnKQogICAgICAgICAgICBwaW4gPSByLmZpbmRhbGwoY2tMaXN0W2ldKQogICAgICAgICAgICBwaW4gPSB1bnF1b3RlKHBpblswXSkKICAgICAgICAgICAgaWYocGluID09ICJqZF83ZjVhNTUxMGVjNzk3Iik6CiAgICAgICAgICAgICAgICBpbmRleCA9IGkKICAgICAgICAgICAgICAgIG15cGluID0gJ2pkXzdmNWE1NTEwZWM3OTcnCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgIGlmKGluZGV4ID09IC0xKToKICAgICAgICAgICAgcHJpbnQoIkRvbid0IGZpbmQgeW91ciBQaW4scGx6IGNoZWNrIGl0ISIpCiAgICBwcmludCgiYGBgVGhlIHBpbiB0aGF0IHlvdSBzZXQgaXMiLCBteXBpbiwgIi5gYGBcbiIpCiAgICBnZXRfYWxsX2NrKCkKICAgIHBvc2l0aW9uKCkKICAgIHNvcnQoKQogICAgc3lzLmV4aXQoMCkK"
exec(base64.b64decode(decode).decode('utf-8'))
